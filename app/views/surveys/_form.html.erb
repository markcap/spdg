<%=javascript_include_tag "surveys"%>
<%= javascript_include_tag :defaults %>
<%= calendar_date_select_includes 'plain' %>

<div id="survey_form">
    <%= error_messages_for :survey %>
    <% form_for @survey do |f| %>
      <p>
        <%= f.label :name %><br />
        <%= f.text_field :name, :class => 'name'%>
      </p>
      <p>
        <%= f.label :project_id, 'Project' %><br />
        <%= f.select :project_id, Project.all.map {|p| [p.name, p.id]}, :prompt => 'Select...' %>
      </p>
      <div class="span-7">
        <%= f.label :starts_on, 'Starts On' %><br />
        <%= f.calendar_date_select :starts_on, :class=> 'date' %>
      </div>
      
        <%= f.label :ends_on, 'Ends On' %><br />
        <%= f.calendar_date_select :ends_on, :class=> 'date'  %><br /><br />

      <% if @show_templates%>
          <%= link_to "Load Template", "#", :class => 'template_link' %>
          <div id="templates">
              <b>Choose a template to load</b><br><br>
              <% SurveyTemplate.all.each do |st|%>
                <%= link_to st.name, new_survey_path(:survey_template_id => st.id)%><br>
              <%end%>
          </div>
          <br><br>
          <hr>
      
          <% if !params[:survey_template_id].nil?%>
            <div id="survey_template">
                <%= render "survey_template", :id => params[:survey_template_id], :f => f%>
            </div>
          <%end%>
      <%end%>
       
      <div id="questions">
          <% f.fields_for :questions do |builder| %>
            <%= render "question_fields", :f => builder %>
          <% end %>
          <div id="add_question_here"></div>
          <%= link_to_add_fields "Add Question", f, :questions %>
          <br> <br>
       </div> 

      <p><%= f.submit "Submit" %></p>
    <% end %>
</div>